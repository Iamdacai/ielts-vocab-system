<!-- pages/learning/learning.wxml -->
<view class="container">
  <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
  <view wx:if="{{loading}}" class="loading-container">
    <text class="loading-text">Âä†ËΩΩ‰∏≠...</text>
  </view>

  <!-- Â≠¶‰π†ÁïåÈù¢ -->
  <view wx:else class="learning-container">
    <!-- ËøõÂ∫¶Êù° -->
    <view class="progress-section">
      <progress 
        percent="{{progress}}" 
        stroke-width="4" 
        active-color="#4a6cf7"
        backgroundColor="#e0e0e0"
        class="progress-bar"
      />
      <view class="progress-text">
        <text>{{currentWordIndex + 1}}/{{totalWords}}</text>
      </view>
    </view>

    <!-- ÂçïËØçÊòæÁ§∫Âå∫Âüü -->
    <view class="word-section">
      <!-- Ëã±ÊñáÂçïËØç + ÂèëÈü≥ÊåâÈíÆÁªÑÂêà -->
      <view class="english-section">
        <text class="english-word">{{currentWord ? currentWord.word : '---'}}</text>
        <!-- Á¥ßÂáëÁöÑÂèëÈü≥ÊåâÈíÆ -->
        <button 
          class="pronunciation-btn-mini" 
          bindtap="playWordPronunciation"
          disabled="{{isPlaying}}"
        >
          <image 
            src="{{isPlaying ? '/assets/icons/playing-small.gif' : '/assets/icons/speaker-small.png'}}" 
            class="icon-mini"
          />
        </button>
      </view>

      <!-- ‰∏≠ÊñáÈáä‰πâÔºàÂèØÊäòÂè†Ôºâ -->
      <view wx:if="{{showAnswer && currentWord}}" class="chinese-section">
        <text class="chinese-meaning">{{currentWord.meaning ? currentWord.meaning : '---'}}</text>
        <!-- Èü≥Ê†áÊòæÁ§∫ -->
        <view wx:if="{{currentWord.phonetic}}" class="phonetic-section">
          <text class="phonetic">{{currentWord.phonetic}}</text>
        </view>
      </view>

      <!-- Á¥ßÂáëÁöÑÂèëÈü≥ÁªÉ‰π†Âå∫Âüü -->
      <view wx:if="{{currentWord}}" class="pronunciation-practice-section">
        <view class="practice-buttons">
          <!-- Ë∑üËØªÊåâÈíÆ - Êõ¥Â∞èÁöÑÂ∞∫ÂØ∏ -->
          <button 
            class="record-btn-mini {{isRecording ? 'recording' : ''}}" 
            bindtap="startPronunciationPractice"
            disabled="{{isRecording}}"
          >
            <image 
              src="{{isRecording ? '/assets/icons/recording-small.gif' : '/assets/icons/mic-small.png'}}" 
              class="icon-mini"
            />
          </button>
          
          <!-- ËØÑÂàÜÁªìÊûúÊòæÁ§∫ - Á¥ßÂáëÂ∏ÉÂ±Ä -->
          <view wx:if="{{pronunciationScore !== null}}" class="score-display-mini">
            <text class="score-text-mini">üéØ {{pronunciationScore}}</text>
          </view>
        </view>
        
        <!-- ÂèçÈ¶à‰ø°ÊÅØ - Â∞èÂ≠ó‰Ωì -->
        <view wx:if="{{pronunciationFeedback}}" class="feedback-mini">
          <text>{{pronunciationFeedback}}</text>
        </view>
      </view>
    </view>

    <!-- Á≠îÊ°àÂàáÊç¢ÊåâÈíÆ -->
    <view class="answer-toggle-section">
      <button 
        class="toggle-btn" 
        bindtap="toggleAnswer"
      >
        {{showAnswer ? 'ÈöêËóèÁ≠îÊ°à' : 'ÊòæÁ§∫Á≠îÊ°à'}}
      </button>
    </view>

    <!-- Êìç‰ΩúÊåâÈíÆÂå∫Âüü - ‰ºòÂåñÂ∏ÉÂ±Ä -->
    <view class="action-section">
      <!-- ÊéåÊè°Á®ãÂ∫¶ÈÄâÊã© - Ê®™ÂêëÊéíÂàóÔºåÊõ¥Á¥ßÂáë -->
      <view class="mastery-section-compact">
        <button class="mastery-btn-compact know-btn" bindtap="handleKnow">
          ‚úì
        </button>
        <button class="mastery-btn-compact hard-btn" bindtap="handleHard">
          ?
        </button>
        <button class="mastery-btn-compact forgot-btn" bindtap="handleForgot">
          ‚úó
        </button>
      </view>

      <!-- ÂØºËà™ÊåâÈíÆ - Â∫ïÈÉ®Âõ∫ÂÆö -->
      <view class="nav-section">
        <button 
          class="nav-btn prev-btn" 
          bindtap="showPreviousWord"
          disabled="{{currentWordIndex === 0}}"
        >
          ‰∏ä‰∏ÄËØç
        </button>
        <button 
          class="nav-btn next-btn" 
          bindtap="showNextWordDirect"
          disabled="{{currentWordIndex >= totalWords - 1}}"
        >
          ‰∏ã‰∏ÄËØç
        </button>
      </view>
    </view>
  </view>
</view>